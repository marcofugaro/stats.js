!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Stats={})}(this,(function(e){"use strict";class t{constructor(e,t,i,s=!0){let n=1/0,l=0;const h=Math.round,a=h(window.devicePixelRatio||1),o=80*a,r=48*a,d=3*a,c=2*a,f=3*a,m=15*a,u=74*a,p=30*a,y=document.createElement("canvas");y.width=o,y.height=r,y.style.cssText="width:80px;height:48px",this.dom=y;const x=y.getContext("2d");x.font=`bold ${9*a}px Helvetica,Arial,sans-serif`,x.textBaseline="top",x.fillStyle=i,x.fillRect(0,0,o,r),x.fillStyle=t,x.fillText(e,d,c),x.fillRect(f,m,u,p),x.fillStyle=i,x.globalAlpha=.9,x.fillRect(f,m,u,p),this.update=(r,g)=>{n=Math.min(n,r),l=Math.max(l,r),x.fillStyle=i,x.globalAlpha=1,x.fillRect(0,0,o,m),x.fillStyle=t;const P=Math.max(2,r.length);x.textAlign="right",x.fillText(`${h(r)}`,d+5*P*a,c),x.textAlign="left";const E=`(${h(n)}-${h(l)})`;x.fillText(`${e} ${s?E:""}`,d+(5*P+2)*a,c),x.drawImage(y,f+a,m,u-a,p,f,m,u-a,p),x.fillRect(f+u-a,m,a,p),x.fillStyle=i,x.globalAlpha=.9,x.fillRect(f+u-a,m,a,h((1-r/g)*p))}}}e.Panel=t,e.default=class{constructor({showMinMax:e=!0,context:i}={}){this.mode=0,this.beginTime=performance.now(),this.prevTime=this.beginTime,this.frames=0,this.REVISION=16;const s=document.createElement("div");s.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",s.addEventListener("click",(e=>{e.preventDefault(),this.showPanel(++this.mode%s.children.length)})),this.dom=s,this.fpsPanel=this.addPanel(new t("FPS","#0ff","#002",e)),this.msPanel=this.addPanel(new t("MS","#0f0","#020",e)),performance&&performance.memory&&(this.memPanel=this.addPanel(new t("MB","#f08","#201",e))),this.queryExtension=i&&i.getExtension("EXT_disjoint_timer_query_webgl2"),this.queryExtension&&(this.gpuPanel=this.addPanel(new t("MS GPU","#f90","#210",e)),this.context=i),this.showPanel(0)}addPanel(e){return this.dom.appendChild(e.dom),e}showPanel(e){for(var t=0;t<this.dom.children.length;t++)this.dom.children[t].style.display=t===e?"block":"none";this.mode=e}begin(){if(this.beginTime=performance.now(),this.gpuPanel){this.queryCreated=!1;let e=!1;if(this.query&&(e=this.context.getQueryParameter(this.query,this.context.QUERY_RESULT_AVAILABLE),e)){const e=30,t=this.context.getQueryParameter(this.query,this.context.QUERY_RESULT),i=Math.min(t/1e3/1e3,e);this.gpuPanel.update(i,e)}!e&&this.query||(this.queryCreated=!0,this.query=this.context.createQuery(),this.context.beginQuery(this.queryExtension.TIME_ELAPSED_EXT,this.query))}}end(){this.frames++;const e=performance.now();if(this.msPanel.update(e-this.beginTime,200),e>=this.prevTime+1e3&&(this.fpsPanel.update(1e3*this.frames/(e-this.prevTime),100),this.prevTime=e,this.frames=0,this.memPanel)){const e=performance.memory;this.memPanel.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return this.queryCreated&&this.context.endQuery(this.queryExtension.TIME_ELAPSED_EXT),e}update(){this.beginTime=this.end()}},Object.defineProperty(e,"__esModule",{value:!0})}));
